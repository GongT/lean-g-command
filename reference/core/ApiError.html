<!DOCTYPE html>
<html>

<head>
	<meta charset='utf-8'>
	<meta http-equiv="X-UA-Compatible" content="chrome=1">
	<meta name="description" content="Lean-g-command : the first leancloud framework">
	
	<link rel="stylesheet" type="text/css" media="screen" href="/stylesheets/stylesheet.css">
	<script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.1.4.min.js"></script>
	<title>the Leancloud framework G</title>
</head>

<body>

<!-- HEADER -->
<div id="header_wrap" class="outer">
	<header class="inner">
		<a id="forkme_banner" href="https://github.com/GongT/lean-g-command">View on GitHub</a>
		
		<h1 id="project_title">the Leancloud framework G</h1>
		
		<h2 id="project_tagline"></h2>
	</header>
</div>

<!-- MAIN CONTENT -->
<div id="main_content_wrap" class="outer">
	<section id="main_content" class="inner">

<div id="ReferenceMenu">
	<h2>目录</h2>
	<ul class="outerList">
		<li>
			<div class="title">核心类</div>
			<ul class="innerList">
				<li>
					<a href="/reference/core/FileSystem.html">FileSystem</a>
				</li>
				<li>
					<a href="/reference/core/LibraryLoader.html">LibraryLoader</a>
				</li>
				<li>
					<a href="/reference/core/ApiError.html">ApiError</a>
				</li>
				<li>
					<a href="/reference/core/InputChecker.html">InputChecker</a>
					<ul class="innerList sub">
						<li>
							<a href="/reference/core/InputCheckerTypes.html">内置类型</a>
						</li>
					</ul>
				</li>
			</ul>
		</li>
		<li>
			<div class="title">应用类</div>
			<ul class="innerList">
				<li>
					<a href="/reference/core/CloudCodeWrapper.html">CloudCodeWrapper</a>
					<ul class="innerList sub">
						<li>
							<a href="/reference/core/CloudCodeWrapperRuntime.html">CloudCodeWrapperRuntime</a>
						</li>
					</ul>
				</li>
				<li>
					<a href="/reference/core/DatabaseModel.html">DatabaseModel</a>
					<ul class="innerList sub">
						<li>
							<a href="/reference/core/DatabaseModelExtend.html">内置扩展方法</a>
						</li>
					</ul>
				</li>
				<li>
					<a href="/reference/core/ExpressController/index.html">ExpressController</a>
					<ul class="innerList sub">
						<li>
							<a href="/reference/core/ExpressController/ExpressControllerRuntime.html">ExpressControllerRuntime</a>
						</li>
						<li>
							<a href="/reference/core/ExpressController/InputHandler.html">InputHandler</a>
						</li>
						<li>
							<a href="/reference/core/ExpressController/PrepareFunction.html">PrepareFunction</a>
						</li>
					</ul>
				</li>
			</ul>
		</li>
		<li>
			<div class="title">工具类</div>
			<ul class="innerList">
				<li>
					<a href="/reference/core/Logger.html">Logger</a>
				</li>
				<li>
					<a href="/reference/core/ServerCloud.html">ServerCloud</a>
				</li>
				<li>
					<a href="/reference/core/InspectCC.html">InspectCC</a>
				</li>
				<li>
					<a href="/reference/core/require_missing.html">require_missing</a>
				</li>
			</ul>
		</li>
		<li>
			<div class="title">辅助类</div>
			<ul class="innerList">
				<li>
					<a href="/reference/core/CallbackList.html">CallbackList</a>
				</li>
				<li>
					<a href="/reference/core/ConfigLoader.html">ConfigLoader</a>
				</li>
				<li>
					<a href="/reference/core/ConfigGenerator.html">ConfigGenerator</a>
				</li>
				<li>
					<a href="/reference/core/DeploySettings.html">DeploySettings</a>
				</li>
				<li>
					<a href="/reference/core/PackageJson.html">PackageJson</a>
				</li>
				<li>
					<a href="/reference/core/single_instance.html">single_instance</a>
				</li>
				<li>
					<a href="/reference/core/source_code_stream.html">source_code_stream</a>
				</li>
			</ul>
		</li>
		<li>
			<div class="title">模板引擎</div>
			<ul class="innerList">
				<li>
					<a href="/reference/view/index.html">基础语法</a>
				</li>
				<li>
					<a href="/reference/view/functions.html">扩展函数列表</a>
				</li>
			</ul>
		</li>
		<li>
			<div class="title">通用函数库</div>
			<ul class="innerList">
			</ul>
		</li>
	</ul>
</div>
<script type="text/javascript">
	$('#ReferenceMenu').on('click', '.outerList > li > .title', function (){
		var $rf = $(this).parent().parent();
		var last = $rf.data('last');
		
		var self = $(this).parent();
		if(last){
			if(last[0] === self[0]){
				return;
			}
			last.removeClass('active').find('ul').hide();
		}
		self.addClass('active').find('ul').show();
		
		$rf.data('last', self);
	})
		.find('[href="' + location.pathname + '"]')
		.addClass('current')
		.parentsUntil('.outerList').find('>.title')
		.click();

</script> 

<h2>目的</h2>
<p>
	统一所有用户级的错误信息，能被客户端轻松的使用。<br/>
	防止代码中使用魔数<br/>
	这些错误对象满足 <code>new ApiError instanceof Error</code>
</p>

<h2>自动生成</h2>
<p>
	通过解析 include/ErrorMessageDefine.json 文件，能自动生成错误对象。<br/>
	这个json文件需要定义一个数组，其每一项都是一个错误码定义，符合以下结构：<br/>
	<code>[错误码, 错误的名称, 错误提示信息]</code><br/>
	其中错误码可以省略，将自动生成不重复的错误码。错误码不能小于0，也不能重复。<br/>
	错误的名称必须以 <code>E_</code> 开头，允许大写英文字母、数字、下划线。<br/>
</p>

<p>
	系统内部存在内置错误码。包括E_SUCCESS，它的错误码总是等于0。<br/>
	以及其他内部错误，这些错误码总是小于0。<br/>
	<br/>
	所有这些错误都能通过 ApiError.E_NAME 访问<br/>
</p>

<h2>API</h2>
<p>
	<code>构造函数(String message, String name, String code)</code><br/>
	分别对应提示信息、名称、错误码<br/>
	创建错误不会将它注册到 <code class="ref">ApiError.E_NAME</code><br/>
</p>

<h3>toJSON()</h3>
<p>
	返回一个JS对象，它包含当前 <code class="ref">ApiError</code> 的全部信息
</p>

<h3>toStrongJSON()</h3>
<p>
	返回一个JS对象，它除了 <code class="ref">toJSON</code> 外，还会去掉所有循环引用
</p>

<h3>stringify()</h3>
<p>
	返回一个字符串，它是 <code class="ref">toStrongJSON</code> 的字符串版本
</p>

<h3>response(Response rsp)</h3>
<p>
	将当前错误对象以json的形式返回给客户端，<code class="var">rsp</code> 是 <code class="lib">express</code> 的
	<code class="var">response</code> 对象
</p>

<h3>data(Any data)</h3>
<p>
	根据当前对象复制并返回新的错误对象，并在新的对象中添加数据 <code class="var">data</code>，<code class="ref">toJSON</code> 时，会增加一个
	<code class="var">data</code> 属性。
</p>

<h3>attach(Object data)</h3>
<p>
	根据当前对象复制并返回新的错误对象，同时附加数据 <code class="var">data</code>，<code class="ref">toJSON</code> 时，会将
	<code class="var">data</code> 扩展到结果数据中。<br/>
	例如可以用 <code class="javascript">ApiError.E_SUCCESS.attach({ message: "重复操作" })</code> 来覆盖默认的 “操作成功”提示<br/>
	切勿覆盖 code 属性，将导致简单的问题变得非常难以捕捉。
</p>

<h3>is(ApiError object)</h3>
<p>
	判断两个错误是否相等，依据是 <code class="var">code</code> 是否相等，如果
	<code class="var">object</code> 不是一个<code class="ref">ApiError</code>，则返回
	<code class="lit">false</code>
</p>

</section>
</div>

<!-- FOOTER  -->
<div id="footer_wrap" class="outer">
	<footer class="inner">
		<p class="copyright">Lean-g-command maintained by
			<a href="https://github.com/GongT">GongT</a>
		</p>
		<p>Published with
			<a href="https://pages.github.com">GitHub Pages</a>
		</p>
	</footer>
</div>

</body>
</html>
